# 1. Reacç»„ä»¶é€šä¿¡æ–¹å¼

1. çˆ¶ä¼ å­ï¼šç”¨ `props` ã€‚
2. çˆ¶ä¼ å­ä¸€ä¸ª `callback`ï¼Œå­ç»„ä»¶é€šè¿‡ `callback` æ›´æ”¹çˆ¶ç»„ä»¶çŠ¶æ€ã€‚
3. `Context` ã€‚
4. `redux` ã€‚
5. ç»„ä»¶è§å…±äº«åŒä¸€ä¸ª `hook` ã€‚





# 2. Context å¯¼è‡´ç»„ä»¶ä¸å¿…è¦æ¸²æŸ“

## 1. å¦‚ä½•æ›´æ–° `value`

`Comsumer` çš„å­ç»„ä»¶æ˜¯æ²¡åŠæ³•ç›´æ¥ä¿®æ”¹ `value` çš„ã€‚éœ€è¦é€šè¿‡çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å‡½æ•°æ¥ä¿®æ”¹ï¼š

```js
const redTheme = { color: 'red' };
const greenTheme = { color: 'green' };

class App extends React.Component {
  state = {
    theme: redTheme;
  }
	switchTheme = theme => this.setState({theme});

	render() {
    return (
    	<Context.Provider value={{theme: this.state.theme, switchTheme: this.switchTheme}}>
      	<div className="App">
      		<Header />
      		<Content />
      		<Somethingelse />
      	</div>
      </Context.Provider>
    )
  }
}
```



## `Context` æ¸²æŸ“è¿‡ç¨‹

1. ç‚¹å‡»æŒ‰é’®ï¼Œè°ƒç”¨äº† `switchTheme` å‡½æ•°ã€‚
2. è¯¥å‡½æ•°è°ƒç”¨äº†é¡¶å±‚ç»„ä»¶ App çš„ `setState` ï¼Œä¿®æ”¹äº†å…¶ä¸­çš„ `theme` ã€‚
3. å› ä¸º App çŠ¶æ€è¢«æ”¹å˜ï¼Œæ‰€ä»¥ App ä¹Ÿè¦è¢«é‡æ–°æ¸²æŸ“ã€‚
4. App é‡æ–°æ¸²æŸ“ï¼Œæ‰€ä»¥ `Context.Provider` ä¹Ÿè¢«é‡æ–°æ¸²æŸ“ã€‚
5. `Context.Provider` æ¸²æŸ“æ—¶å‘ç° `value` æœ‰å˜åŒ–ï¼Œæ‰€ä»¥æ‰€æœ‰çš„å­ç»„ä»¶éƒ½è¦é‡æ–°æ¸²æŸ“ã€‚

æ˜æ˜¾çœ‹å‡ºï¼Œæ¸²æŸ“è¿‡åº¦äº†ï¼Œä¸åº”è¯¥æ‰€æœ‰çš„å­ç»„ä»¶éƒ½è¢«æ¸²æŸ“ï¼ŒçœŸæ­£ç”¨åˆ° `value` çš„å­ç»„ä»¶è¢«æ¸²æŸ“å°±å¥½ã€‚



## æ”¹è¿›æ–¹æ³•

ä¸Šé¢ä¼šè¿‡åº¦æ¸²æŸ“çš„æœ¬è´¨åŸå› æ˜¯ï¼š`<Context.Provider>` çš„å­ç»„ä»¶å†…å®¹æ¯æ¬¡éƒ½ç»™ `React.createElement` åˆ›å»ºå¯¹è±¡ï¼Œå³ä½¿å†…å®¹æ²¡å®Œå…¨æ”¹å˜ï¼Œä½†æ˜¯å¼•ç”¨å˜äº†ã€‚è¿™ä¸ª JSX è½¬æˆ js å¯¹è±¡æ˜¯è¿™æ ·è½¬åŒ–çš„ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½è¦ç”Ÿæˆæ–°å†…å®¹ã€‚

```js
React.createElement(Context.Provider, {value: ...},
  React.createElement('div', {className: ...},
    React.createElement(Header),
    React.createElement(Content),
  )
)
```

æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦æƒ³åŠæ³•æŠŠè¿™ä¸ªå¼•ç”¨ç»™å®šæ­»ï¼Œæ›´æ–°æ—¶åªæ”¹å˜åœ°å€ä¸­çš„å†…å®¹ã€‚è¿™æ ·ï¼Œä¸æ”¹å˜çš„ç»„ä»¶å°±ä¸ä¼šé‡ç»˜ã€‚åˆ¶é€ ä¸€ä¸ª `ThemeProvider` ç»„ä»¶ï¼Œç„¶åæŠŠå­ç»„ä»¶éƒ½æ”¾åœ¨ `this.props.children` ä¸­ã€‚è¿™æ ·ä¼šè®©çˆ¶ç»„ä»¶ `App` å˜æˆä¸€ä¸ªæ— çŠ¶æ€çš„ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„çŠ¶æ€ä¸ä¼šç»‘å®šåœ¨ `Context` ä¸Šï¼Œæ‰€ä»¥åˆ†ç¦»å¼€ä¹‹åï¼Œå°±ä¸ä¼šæ”¶åˆ°å½±å“ã€‚

```js
class ThemeProvider extends React.Component {
  state = {
    theme: redTheme,
  }
  switchTheme = (theme) => {
    this.setState({theme});
  }
  render() {
    console.log('render ThemeProvider');
    return (
      <Context.Provider value={{theme: this.state.theme, switchTheme: this.switchTheme}}>
        {this.props.children}
      </Context.Provider>
    );
  }
}

function App () {
  console.log('render App');
  return (
    <ThemeProvider>
      <div className="App">
        <Header />
        <Content />
      </div>
    </ThemeProvider>
  )
}
```





# 3. Hooks çš„å¥½å¤„

1. å‡½æ•°éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œæ‰€ä»¥ä¼šå¼€è¾Ÿç‹¬ç«‹ç©ºé—´ä¿å­˜çŠ¶æ€ã€‚
2. ==æ›´å¥½å¤ç”¨==ï¼šå¤ç”¨é€»è¾‘æ—¶ç±»ç»„ä»¶éœ€è¦å†™é«˜é˜¶ç»„ä»¶å‡½æ•°ï¼Œhooks å¯ä»¥é€šè¿‡ `useHooks` å‡½æ•°å°±èƒ½ç›´æ¥æŠŠå†…å®¹ä¼ é€’ç»™å¤ç”¨çš„ç»„ä»¶ã€‚
3. å‰¯ä½œç”¨ `useEffect` å¯ä»¥æ›¿ä»£ `componentDidMount` ã€`componentDidUpdate` ã€`componentWillUnmount` ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚



## ç¼ºç‚¹

1. `useEffect` é—­åŒ…é™·é˜±ï¼š

```js
const [count, setCount] = useState(0);
useEffect(() => {
  window.addEventListener('resize', handleResize);
  return () => window.removeEventListener('resize', handleResize);
}, [count]);
const handleResize = () => console.log('count', count);
```

 ä¸Šé¢çš„æ¡ˆä¾‹å¿…é¡»è¦åœ¨ `useEffect` æ€»åŠ å…¥ `count` æ‰èƒ½å®æ—¶æ‰“å°å‡ºæ¥æ­£ç¡®çš„ `count` ã€‚è¿™å°±æ˜¯é—­åŒ…é™·é˜±ï¼Œä¹ä¸€çœ‹é€šè¿‡é—­åŒ…èƒ½è®¿é—®åˆ° `count` ã€‚ä½†å®é™…ä¸Šç°åœ¨çš„ `count` å’Œæ›´æ–°åçš„ `count` å·²ç»ä¸ä¸€æ ·äº†ï¼Œæ˜¯æ–°çš„çŠ¶æ€ã€‚è¿™å°±æ˜¯ç”±å‡½æ•°çš„ä½œç”¨åŸŸé€ æˆçš„ã€‚ä½†æ˜¯ `hooks` å‡½æ•°ä¸­ä»ç„¶ä¿å­˜ç€ä¸Šä¸€æ¬¡çš„è®°å¿†ã€‚æ‰€ä»¥æˆ‘ä»¬è¦è®°ä½è¿™ç§ï¼Œé—­åŒ…é™·é˜±ã€‚



## `memo`|`useMemo`|`useCallback` æœ€ä½³åœºæ™¯

`useCallback` å’Œ `useMemo` çš„åŒºåˆ«ï¼š

å…±åŒç‚¹ï¼šéƒ½æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ¥æ”¶å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ¥æ”¶æ•°ç»„ã€‚ç”¨æ¥ç¼“å­˜æ•°æ®ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚

ä¸åŒç‚¹ï¼š

- `useCallback` ç¼“å­˜çš„æ˜¯å‡½æ•°ï¼Œå¦‚æœæ¯æ¬¡æ›´æ–°æ—¶è¿™ä¸ªå‡½æ•°åªä¾èµ–å…¶ä¸­ä¸€ä¸ªå˜é‡ï¼Œå½“è¿™ä¸ªå˜é‡å‘ç”Ÿå˜åŒ–æ—¶æ‰æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œè¿™å°±æ˜¯ `useCallback` çš„ä½¿ç”¨åœºæ™¯ã€‚
- `useMemo` ç¼“å­˜çš„æ˜¯æ•°æ®ï¼Œæ˜¯ç¬¬ä¸€ä¸ªå‚æ•°è¿”å›çš„è¿”å›å€¼ã€‚



`React.memo` æ–¹æ³•å°±ç›¸å½“äº `PureComponent` ã€‚`React.memo` å¾ˆå¥½è§£é‡Šã€‚å¦‚ä¸‹ï¼Œå­ç»„ä»¶æ²¡å¿…è¦å»æ¸²æŸ“æ—¶åœ¨å­ç»„ä»¶ä¸Šå¥—ä¸Š `memo()` å°±å¥½ï¼š

```js
function Dad(){
  const [count, setCount] = useState(0);
	return (
  	<div>
    	<button onClick={()=>setCount(count+1)}>add</button>
			<MemoChild />
    </div>
  )
}

const MemoChild = React.memo(Child);

function Child(){
	console.log('i am renderer');
  return (
  	<div>æˆ‘æ˜¯å­ç»„ä»¶</div>
  )
}
```



ä¸‹é¢çœ‹çœ‹ `useCallback` å’Œ `useMemo` çš„å®è·µåœºæ™¯ã€‚è¿˜æ˜¯åŒæ ·çš„åœºæ™¯ï¼Œå¤šå¢åŠ ä¸€ä¸ª `name` çŠ¶æ€å’Œæ”¹å˜æ–¹æ³•ã€‚è¿™æ—¶å€™å°±æœ‰ä¸¤ä¸ªçŠ¶æ€äº†ï¼Œäº’ç›¸çš„æ–¹æ³•å¦‚æœä¸€ä¸ªè°ƒç”¨ä¸€ä¸ªæ²¡è°ƒç”¨ï¼Œå°±åº”è¯¥åˆ†åˆ«æ¸²æŸ“ï¼Œä¸èƒ½è¿‡åº¦ã€‚

```js
function Dad(){
  const [count, setCount] = useState(0);
  const [name, setName] = useState('123')
	return (
  	<div>
    	<button onClick={()=>setCount(count+1)}>add</button>
			<MemoChild name={name} onClick={newName => setName(newName)} />
    </div>
  )
}

const MemoChild = React.memo(Child);

function Child(props){
	console.log('i am renderer');
  return (
    <div>
  		<h1>æˆ‘æ˜¯å­ç»„ä»¶</h1>
    	<div>{props.name}</div>
    	<button onClick={props.onClick('456')}>changeName</button>
    </div>
  )
}
```

å¦‚ä¸Šï¼Œå½“æˆ‘ç‚¹å‡» `add` æŒ‰é’®æ—¶ï¼Œå­ç»„ä»¶è¿˜æ˜¯ä¼šæ¸²æŸ“ï¼Œå› ä¸ºå­ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶å‡½æ•°ä¹Ÿè·Ÿç€æ‰§è¡Œäº†ã€‚æ‰€ä»¥æˆ‘ä»¬é€šè¿‡ `useCallback` åŒ…è£¹ `setName` çš„æ–¹æ³•å°±å¯ä»¥è§£å†³ã€‚

```js
function Dad(){
  const [count, setCount] = useState(0);
  const [name, setName] = useState('123')
	return (
  	<div>
    	<button onClick={()=>setCount(count+1)}>add</button>
			<MemoChild name={name} onClick={useCallback(newName => setName(newName), [])} />
    </div>
  )
}
```

è½»æ¾è§£å†³ã€‚

é‚£ä¹ˆ `useMemo` å¦‚ä½•ç”¨å‘¢ï¼ŸæŠŠè¿™ä¸ª `name` æ¢æˆä¸€ä¸ªå¯¹è±¡ã€‚

```js
function Dad(){
  const [count, setCount] = useState(0);
  const [name, setName] = useState('123')
	return (
  	<div>
    	<button onClick={()=>setCount(count+1)}>add</button>
			<MemoChild 
				childData={{name, color: name==='123' ? 'red' : 'green'}} 					onClick={useCallback(newName => setName(newName), [])}
      />
    </div>
  )
}
```

è¿™æ—¶ï¼Œç”¨äº† `useCallback` å¤±æ•ˆçš„åŸå› æ˜¯ï¼šä¼ å…¥çš„å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè®¡ç®—ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šé‡æ–°è®¡ç®—ã€‚æ‰€ä»¥æˆ‘ä»¬è¦ç”¨åˆ° `useMemo` ï¼Œç¼“å­˜çš„æ˜¯æ•°æ®ã€‚å¯¹è±¡å¦‚æœå‘ç”Ÿæ”¹å˜æ‰æ¸²æŸ“å­ç»„ä»¶ã€‚

```js
childData={useMemo(()=>({name, color: name==='123' ? 'red' : 'green'}))};
```



# 4. çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«

æ ¹æœ¬åŒºåˆ«ï¼šè¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹æ˜¯ä»»åŠ¡è°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½ã€‚

å¦ä¸€ç§è¯´æ³•ï¼šè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•ä½ã€‚

è¿›ç¨‹=ç«è½¦ï¼Œçº¿ç¨‹=è½¦å¢ã€‚

- ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ã€‚
- ä¸åŒè¿›ç¨‹é—´æ•°æ®å¾ˆéš¾å…±äº«(ä¸¤ä¸ªç«è½¦ä¹‹é—´ä¹˜å®¢å¾ˆéš¾æ¢è½¦ï¼Œä½†æ˜¯ä¹˜å®¢åœ¨åŒä¸€è¾†è½¦çš„è½¦å¢ä¸­å¾ˆå®¹æ˜“æ¢ã€‚æ‰€ä»¥çº¿ç¨‹é—´é€šä¿¡ç®€å•)ã€‚
- è¿›ç¨‹é—´ä¸ä¼šç›¸äº’å½±å“ï¼Œä½†æ˜¯çº¿ç¨‹ä¸­ä¸€ä¸ªçº¿ç¨‹æŒ‚äº†ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹æŒ‚æ‰ã€‚



## è¿›ç¨‹é—´é€šä¿¡æ–¹å¼

1. **åŒ¿åç®¡é“**ï¼šåŠåŒå·¥æ–¹å¼ã€‚åªèƒ½åœ¨çˆ¶å­è¿›ç¨‹ä¸­ä½¿ç”¨ã€‚
2. **é«˜çº§ç®¡é“**ï¼šå°†å¦ä¸€ä¸ªç¨‹åºå½“ä½œä¸€ä¸ªæ–°çš„è¿›ç¨‹åœ¨å½“å‰ç¨‹åºè¿›ç¨‹ä¸­å¯åŠ¨ï¼Œç®—ä½œå½“å‰ç¨‹åºçš„å­è¿›ç¨‹ã€‚
3. **æœ‰åç®¡é“**ï¼šåŠåŒå·¥ï¼Œå…è®¸æ— äº²ç¼˜å…³ç³»è¿›ç¨‹é—´é€šä¿¡ã€‚
4. **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šç”±æ¶ˆæ¯çš„é“¾è¡¨æ„æˆï¼Œå­˜æ”¾åœ¨å†…æ ¸ä¸­ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚
5. **ä¿¡å·é‡**ï¼šæ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¯ä»¥æ§åˆ¶å¤šä¸ªè¿›ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚æ˜¯ä¸€ç§é”æœºåˆ¶ï¼Œé˜²æ­¢æŸè¿›ç¨‹æ­£åœ¨å…±äº«èµ„æºæ—¶ï¼Œå…¶ä»–è¿›ç¨‹ä¹Ÿè®¿é—®è¯¥èµ„æºã€‚
6. **ä¿¡å·**ï¼šç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿã€‚
7. **å…±äº«å†…å­˜**ï¼šæ˜ å°„ä¸€æ®µèƒ½è¢«å…¶ä»–è¿›ç¨‹è®¿é—®çš„å†…å­˜ã€‚è¿™æ®µå…±äº«å†…å­˜ç”±ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºï¼Œä½†å¤šä¸ªè¿›ç¨‹éƒ½å¯ä»¥è®¿é—®ã€‚
8. **Socket**ï¼šå¯ç”¨äºä¸åŒæœºå™¨é—´çš„è¿›ç¨‹é€šä¿¡ã€‚



## å‚è€ƒ

1. https://blog.csdn.net/weixin_44653395/article/details/99686244



# 5. ä¸ºä»€ä¹ˆ Chrome ä½¿ç”¨å¤šè¿›ç¨‹æ¶æ„

å¤šè¿›ç¨‹å®‰å…¨æ€§æ›´å¥½ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯ï¼Œåªä¼šåœ¨é‚£ä¸€ä¸ªè¿›ç¨‹ä¸­å‡ºé”™ï¼Œä¸å½±å“å…¶ä»–è¿›ç¨‹ã€‚

## Chrome è¿›ç¨‹

Chrome æœ‰ä¸‰ç§ç±»å‹çš„è¿›ç¨‹ï¼šæµè§ˆå™¨è¿›ç¨‹ã€æ¸²æŸ“å™¨è¿›ç¨‹ã€æ’ä»¶è¿›ç¨‹ã€‚

- æµè§ˆå™¨è¿›ç¨‹ï¼šåªæœ‰ä¸€ä¸ªï¼Œç”¨äºç®¡ç†æ ‡ç­¾é¡µã€çª—å£å’Œæµè§ˆå™¨æœ¬èº«ã€‚è¿™ä¸ªè¿›ç¨‹åŒæ—¶è´Ÿè´£å¤„ç†æ‰€æœ‰è·Ÿç£ç›˜ã€ç½‘ç»œã€ç”¨æˆ·è¾“å…¥å’Œæ˜¾ç¤ºçš„äº¤äº’ï¼Œä¸è´Ÿè´£åˆ†æå’Œæ¸²æŸ“é¡µé¢å†…å®¹ã€‚
- æ¸²æŸ“å™¨è¿›ç¨‹ï¼šä¼šåˆ›å»ºå¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªéƒ½è´Ÿè´£æ¸²æŸ“é¡µé¢ã€‚åŒ…æ‹¬ HTMLã€Javscriptã€CSSå’Œå›¾ç‰‡ç­‰æ–‡ä»¶çš„å¤„ç†ã€‚æ¯ä¸ªæ¸²æŸ“å™¨è¿›ç¨‹éƒ½è¿è¡Œåœ¨æ²™ç®±å†…ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰å¯¹ç£ç›˜ã€ç½‘ç»œå’Œæ˜¾ç¤ºå™¨çš„ç›´æ¥è®¿é—®æƒé™ã€‚
- æ’ä»¶è¿›ç¨‹ï¼šä¸ºæ¯ä¸ªæ’ä»¶åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ã€‚



## å‚è€ƒ

1. https://blog.csdn.net/ithzhang/article/details/7917754



# 6. Chrome åƒåœ¾å›æ”¶

åŸºæœ¬ç±»å‹çš„æ•°æ®éƒ½æ˜¯ä¿å­˜åœ¨â€œæ ˆâ€ä¸­çš„ï¼Œå¼•ç”¨ç±»å‹çš„æ•°æ®éƒ½æ˜¯ä¿å­˜åœ¨â€œå †â€ä¸­çš„ã€‚

## æ ˆå†…å­˜å›æ”¶

å½“æ‰§è¡Œå®Œæ ˆä¸­çš„å‡½æ•°åï¼Œå°±è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œç„¶åæ ˆé¡¶çš„ç©ºé—´ä¼šè‡ªåŠ¨è¢«å›æ”¶ï¼Œé‡Šæ”¾å†…å­˜ã€‚

## å †å†…å­˜å›æ”¶

V8 æŠŠå†…å­˜åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ï¼š

- æ–°ç”Ÿä»£ï¼šä¸´æ—¶åˆ†é…çš„å†…å­˜ï¼Œå­˜æ´»æ—¶é—´çŸ­ã€‚
- è€ç”Ÿå¸¦ï¼šå¸¸é©»å†…å­˜ï¼Œå­˜æ´»æ—¶é—´é•¿ã€‚

## æ–°ç”Ÿä»£å›æ”¶

1. å°†æ–°ç”Ÿä»£å†…å­˜ç©ºé—´ä¸€åˆ†ä¸ºäºŒï¼Œ`From` éƒ¨åˆ†æ˜¯æ­£åœ¨ä½¿ç”¨çš„å†…å­˜ï¼Œ`To` æ˜¯é™åˆ¶çš„å†…å­˜ã€‚

![v8-gc2](images/v8-gc2.png)

2. å…ˆæŠŠ `From` éƒ¨åˆ†å¯¹è±¡æ£€æŸ¥ä¸€éï¼Œå¦‚æœæ˜¯å­˜æ´»å¯¹è±¡å°±æ”¾ç½®åœ¨ `To` å†…å­˜ä¸­ï¼Œéå­˜æ´»å¯¹è±¡ä¹‹é—´å›æ”¶ã€‚
3. ç„¶å `From` å’Œ `To` èº«ä»½å¯¹è°ƒï¼Œ`From` ä¸­çš„ä½œä¸ºé—²ç½®ï¼Œ`To` ä¸­çš„ä½œä¸ºæ­£åœ¨ä½¿ç”¨çš„ã€‚

æŒ‰ç…§ä¸Šè¿°å¾ªç¯ã€‚ä¸ºä»€ä¹ˆä¸ç›´æ¥åˆ é™¤éå­˜æ´»çš„ï¼Ÿ

==è¿™æ ·å¯¹è°ƒæ˜¯ä¸ºäº†è®©å†…å­˜è¿ç»­ï¼Œè§£å†³å†…å­˜ç¢ç‰‡çš„é—®é¢˜ã€‚==
ç”¨è¿™ç§ `Scavenge` ç®—æ³•çš„å¥½å¤„æ˜¯ï¼šæ–°ç”Ÿä»£å†…å­˜å˜é‡å¾ˆå°‘ï¼Œæ‰€ä»¥æ—¶é—´æ€§èƒ½å¾ˆä¼˜ç§€ã€‚

![v8-gc3](images/v8-gc3.png) =>        ![v8-gc4](images/v8-gc4-20210222205332198.png)



## è€ç”Ÿä»£å†…å­˜å›æ”¶

å¦‚æœä¸Šè¿°çš„æ–°ç”Ÿä»£å†…å­˜ä¸­ï¼Œæœ‰äº›å˜é‡ç»è¿‡å¤šæ¬¡å¯¹è°ƒå›æ”¶æ“ä½œåä¾ç„¶å­˜åœ¨ï¼Œå°±æŠŠè¿™ç§å˜é‡æ”¾åˆ°è€ç”Ÿä»£ä¸­ã€‚è€ç”Ÿä»£ä¸­å¯¹è±¡éå¸¸å¤šï¼Œç”¨è¿™ç§å¤åˆ¶æ“ä½œå·¥ç¨‹é‡å¤ªå¤§ã€‚æ‰€ä»¥é‡‡ç”¨ä¸‹é¢çš„ç­–ç•¥ï¼š

1. è¿›è¡Œ==æ ‡è®°â€”æ¸…é™¤==ã€‚éå†å †ä¸­æ‰€æœ‰å¯¹è±¡ï¼Œåšæ ‡è®°ã€‚åˆ é™¤æ²¡æœ‰æ ‡è®°çš„ã€‚è¿™æ ·è‚¯å®šä¼šé€ æˆå¤§é‡çš„å†…å­˜ç¢ç‰‡ã€‚
2. æ•´ç†å†…å­˜ç¢ç‰‡ã€‚åœ¨æ¸…é™¤é˜¶æ®µæ¥æ”¶åï¼ŒæŠŠå­˜æ´»çš„å¯¹è±¡å‘ä¸€ç«¯é æ‹¢ã€‚ç”±äºç§»åŠ¨ï¼Œæ‰€ä»¥æ‰§è¡Œé€Ÿåº¦å¾ˆæ…¢çš„ã€‚

ä¸ºäº†æ”¹å–„æ€§èƒ½é—®é¢˜ï¼Œåœ¨ä¸Šè¿°åŸºç¡€ä¸Šä½¿ç”¨==å¢é‡æ ‡è®°ç®—æ³•==ã€‚ä¹Ÿå°±æ˜¯åƒåœ¾å›æ”¶æ ‡è®°å’Œ JS åº”ç”¨é€»è¾‘äº¤æ›¿è¿›è¡Œï¼Œé—²æ—¶å›æ”¶ï¼Œç›´åˆ°æ ‡è®°é˜¶æ®µå®Œæˆã€‚



# 7. å†…å­˜æ³„æ¼

## å†…å­˜æ³„æ¼çš„æƒ…å†µ

1. å®šæ—¶å™¨ä¸­å¼•ç”¨æ²¡æœ‰æ¸…é™¤ï¼š

   ```js
   var someDate = getData();
   setInterval(() => {
     var node = document.getElementById('Node');
     if(node) node.innerHTML = JSON.stringify(someData);
   })
   ```

   å½“å®šæ—¶å™¨æ²¡æœ‰æ¸…é™¤ï¼Œå¹¶ä¸”è¿™ä¸ª Node èŠ‚ç‚¹è¢«åˆ é™¤åï¼Œè¿™ä¸ªé€»è¾‘å°±ä¸éœ€è¦äº†ã€‚ä½†æ˜¯è®¡æ—¶å™¨ä¸­çš„å›è°ƒå‡½æ•°å´æ— æ³•è¢«å›æ”¶ï¼Œ`someData` æ•°æ®ä¹Ÿæ²¡æ³•å›æ”¶ã€‚

2. å…¨å±€å˜é‡ï¼š

   ```js
   function foo(){
   	this.a = "something";
   }
   foo();
   ```

   è¿™é‡Œçš„ `foo` åœ¨å…¨å±€ç¯å¢ƒè°ƒç”¨ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ `window.bar=xxx` ã€‚äº§ç”Ÿçš„å…¨å±€å˜é‡æ— æ³•å›æ”¶ã€‚

3. é—­åŒ…äº§ç”Ÿäº’ç›¸å¼•ç”¨ã€‚

## é¿å…å†…å­˜æ³„æ¼

1. å°‘ç”¨å…¨å±€å˜é‡ï¼Œé¿å…æ„å¤–äº§ç”Ÿå…¨å±€å˜é‡ã€‚
2. ä½¿ç”¨é—­åŒ…è¦æ³¨æ„ï¼Œæœ‰ DOM å…ƒç´ å¼•ç”¨è¦åŠæ—¶æ¸…é™¤ã€‚
3. è®¡æ—¶å™¨ä¸­çš„æ²¡ç”¨çš„å›è°ƒè¦åŠæ—¶ä¸‹äºã€‚
4. å¯ä»¥ç”¨ `WeakSet` å’Œ `WeakMap` ç»“æ„ï¼Œä»–ä»¬éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶ã€‚





# 8. OSI ä¸ƒå±‚æ¨¡å‹éƒ½æœ‰å“ªäº›åè®®

![network-model](images/network-model.png)



- æ•°æ®é“¾è·¯å±‚ï¼šPPP åè®®(ç‚¹å¯¹ç‚¹è¿æ¥ä¼ è¾“æ•°æ®å•å…ƒ)ã€‚
- ç½‘ç»œå±‚ï¼š

  - IP åè®®ï¼šæ‰€æœ‰äº’è”çš„è®¡ç®—æœºéƒ½éœ€è¦éµå¾ªè¯¥åè®®ï¼Œä¸¤ä¸ª IP ä¹‹é—´çš„é€»è¾‘é€šä¿¡ã€‚
  - ARP åè®®ï¼šARP ç¼“å­˜è¡¨ï¼Œå­˜å‚¨ IP åœ°å€å’Œ MAC åœ°å€æ˜ å°„å…³ç³»çš„ã€‚
  - ICMP(Internet Control Message Protocol) ï¼š**äº’è”ç½‘æ§åˆ¶æ¶ˆæ¯åè®®**ã€‚ä¸ºäº†æé«˜ IP æŠ¥äº¤ä»˜ç‡ï¼ŒICMP å…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›å¼‚å¸¸æŠ¥å‘Šç»™å‘é€è€…ã€‚
  - IGMP(Internet Group Management Protocol) ï¼š**ç½‘ç»œç¾¤ç»„ç®¡ç†åè®®ã€‚**ç”¨äºç®¡ç†ç½‘ç»œåè®®å¤šæ’­ç»„æˆå‘˜çš„é€šä¿¡åè®®ã€‚IP ä¸»æœºå’Œç›¸é‚»è·¯ç”±å™¨å¯ä»¥åˆ©ç”¨ IGMP å»ºç«‹å¤šæ’­ç»„çš„ç»„æˆå‘˜ã€‚
- ä¼ è¾“å±‚ï¼š
	- UDP
  - TCP
- åº”ç”¨å±‚
  - FTPï¼šæ–‡ä»¶ä¼ è¾“åè®®ã€‚
  - TELNETï¼šè¿œç¨‹ç»ˆç«¯åè®®ã€‚
  - WWWï¼šä¸‡ç»´ç½‘åè®®ã€‚å…¶ä¸­åŒ…æ‹¬ URLã€HTTPã€HTML ä¸‰ç§åè®®ã€‚

  

## å‚è€ƒ

1. https://juejin.cn/post/6844904049800642568







# 9. TCP å¯é ä¼ è¾“çš„åŸç†

## 1. åœæ­¢ç­‰å¾…åè®®

å¦‚æœæ˜¯ A å‘é€æ•°æ®ç»™ B æ—¶ä¸¢å¤±ï¼Œåˆ™ B æ— æ³•æ”¶åˆ°æ•°æ®ï¼Œç¨‹åºä¸€ç›´ç­‰å¾…ã€‚

**è§£å†³æ–¹æ¡ˆï¼šè¶…æ—¶é‡ä¼ ã€‚**



B æ”¶åˆ°äº†æ•°æ®ï¼Œå‘é€çš„ç¡®è®¤æ•°æ®å‡ºç°ä¸¢å¤±æˆ–å¾ˆé•¿æ—¶é—´åˆ°è¾¾ Aã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

1. å¦‚æœæ˜¯ç¡®è®¤ä¸¢å¤±äº†ï¼Œå½“è¶…æ—¶é‡ä¼ åï¼ŒB ä¸¢å¼ƒé‡å¤æ”¶åˆ°çš„æ•°æ®ã€‚
2. å¦‚æœæ˜¯ç¡®è®¤å»¶è¿Ÿåˆ°è¾¾ï¼ŒA ä¼šæ”¶åˆ°ä¸¤æ¬¡ç¡®è®¤æ¶ˆæ¯ã€‚A å°±ä¸¢å¼ƒå»¶æ—¶åˆ°è¾¾çš„ç¡®è®¤ï¼Œä¸åšå…¶ä»–å¤„ç†ã€‚





## 2. è¿ç»­ ARQ åè®®

æŒ‰ç…§çª—å£é•¿åº¦æŠŠè¿ç»­åˆ†ç»„å‘é€å‡ºå»ï¼Œå‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªç¡®è®¤æ—¶å°±æŠŠå‘é€çª—å£å‘å‰æ»‘åŠ¨ä¸€ä¸ªåˆ†ç»„çš„ä½ç½®ã€‚

æ¥æ”¶æ–¹ä¹Ÿæ˜¯é€šè¿‡ç´¯ç§¯ç¡®è®¤çš„æ–¹å¼ã€‚

å¦‚æœæœ‰ä¸¢å¤±çš„åˆ†ç»„ï¼Œæ²¡æ”¶åˆ°ç¡®è®¤ä¼šè¿›è¡Œå›é€€ `Go Back N` ã€‚



## æ‹¥å¡æ§åˆ¶

TCP é‡‡ç”¨æ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ å’Œå¿«æ¢å¤å››ç§ç®—æ³•æ¥è¿›è¡Œæ‹¥å¡æ§åˆ¶ã€‚

### 1. æ…¢å¯åŠ¨

æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…éƒ½æ˜¯åŸºäºçª—å£çš„æ‹¥å¡æ§åˆ¶ï¼šå‘é€æ–¹ç»´æŒä¸€ä¸ªæ‹¥å¡çª—å£ï¼Œå…¶é•¿åº¦å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶åŠ¨æ€å˜åŒ–ï¼ŒåŒæ—¶å‘é€æ–¹ä¼šè®©è‡ªå·±çš„å‘é€çª—å£ç­‰äºæ‹¥å¡çª—å£ã€‚

==æ…¢å¯åŠ¨ï¼šç”±äºä¸çŸ¥é“ç½‘ç»œçš„è´Ÿè½½èƒ½åŠ›ï¼Œæ‰€ä»¥æœ€å¥½é€‰æ‹©é€æ­¥æ¢æµ‹ï¼Œç”±å°åˆ°å¤§æˆå€åœ°å¢å¤§å‘é€çª—å£ã€‚==



 ![](https://user-gold-cdn.xitu.io/2020/1/17/16fb20a0bf639c89?imageslim )

æ‹¥å¡é¿å…å°±æ˜¯åˆ©ç”¨æ¯æ¬¡ç»“æœä¸€ä¸ªå¾€è¿”æ—¶é—´åæŠŠå‘é€æ–¹çš„çª—å£ + 1ï¼Œè¾¾åˆ°æŸä¸ªå€¼æ—¶ç¨³å®šå°è¯•ã€‚



### 2. å¿«é‡ä¼ å’Œå¿«æ¢å¤

å¿«é‡ä¼ ç®—æ³•è¦æ±‚æ¥æ”¶æ–¹ä¸è¦ç­‰å¾…è‡ªå·±å‘é€æ•°æ®æ—¶æ‰ç¨å¸¦ç¡®è®¤ï¼Œè¦ç«‹åˆ»å‘é€ç¡®è®¤ã€‚å³ä½¿æ”¶åˆ°äº†å¤±åºæŠ¥æ–‡æ®µï¼Œä¹Ÿè¦ç«‹å³å‘å‡ºå¯¹å·²æ”¶åˆ°æŠ¥æ–‡æ®µçš„é‡å¤ç¡®è®¤ã€‚å‘é€æ–¹æ”¶åˆ°è¿ç»­ 3 ä¸ªåŒä¸€åˆ†ç»„ç¡®è®¤æŠ¥åä¼šç«‹å³å¿«é‡ä¼ å®ƒçš„ä¸‹ä¸€æ®µã€‚

![](https://user-gold-cdn.xitu.io/2020/1/17/16fb20a0ea75f1d0?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)







# 10. DNS é€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢

## é€’å½’æŸ¥è¯¢

DNS æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªå‡†ç¡®çš„æŸ¥è¯¢ç»“æœå›å¤å®¢æˆ·ã€‚å¦‚æœæœ¬åœ°æ²¡æŸ¥åˆ°ï¼Œå°±è¯¢é—®å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶å°†è¿”å›çš„æŸ¥è¯¢ç»“æœæäº¤ç»™å®¢æˆ·ç«¯ã€‚

==ä¸»æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨çš„æŸ¥è¯¢ä¸€èˆ¬ç”¨é€’å½’ã€‚==



## è¿­ä»£æŸ¥è¯¢

DNS æœåŠ¡å™¨æŸ¥è¯¢ä¸åˆ°æœ¬åœ°åˆ°å…¶ä»–æœåŠ¡å™¨æŸ¥è¯¢åå¹¶ä¸ç›´æ¥å›å¤æŸ¥è¯¢ç»“æœï¼Œè€Œæ˜¯å‘Šè¯‰å®¢æˆ·ç«¯å¦ä¸€å° DNS æœåŠ¡å™¨çš„åœ°å€ï¼Œè®©é‚£ä¸ªå®¢æˆ·ç«¯å†å‘é‚£ä¸€å° DNS æœåŠ¡å™¨æäº¤è¯·æ±‚ã€‚

ç®€å•æ¥è¯´é€’å½’å®¢æˆ·ç«¯åªä¼šå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¦æ±‚å¯¹æ–¹ç»™ç»“æœã€‚è¿­ä»£çš„è¯ï¼Œå‘å‡ºè¯·æ±‚åå¦‚æœæ²¡æœ‰æˆæƒå›ç­”ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªèƒ½è§£ç­”è¿™ä¸ªæŸ¥è¯¢çš„æœåŠ¡å™¨åˆ—è¡¨ï¼Œå®¢æˆ·ç«¯éœ€è¦å†å‘è¯·æ±‚ç»™è¯¥åˆ—è¡¨ã€‚



# 11. Reactå’ŒVUEåŒºåˆ«

## 1. ç›‘å¬æ•°æ®çš„åŸç†ä¸åŒ

- Vue é€šè¿‡ getter/setter ç­‰å‡½æ•°åŠ«æŒï¼Œå¾—åˆ°æ•°æ®çš„ç²¾ç¡®å˜åŒ–ã€‚
- React å¼ºè°ƒæ•°æ®çš„ä¸å¯å˜ï¼Œæ˜¯é€šè¿‡ diff ç®—æ³•æ¯”è¾ƒå¼•ç”¨æ¥è¿›è¡Œçš„ï¼Œæ‰€ä»¥å¦‚æœä¸ä¼˜åŒ–å°±ä¼šé€ æˆå¤§é‡ä¸å¿…è¦çš„ vDOM æ¸²æŸ“ã€‚





## 2. æ•°æ®æµä¸åŒ

 ![](https://img-blog.csdnimg.cn/20190626150140570.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTkwMTc3,size_16,color_FFFFFF,t_70)



React ä¸€ç›´ä¸æ”¯æŒåŒå‘ç»‘å®šï¼Œæå€¡æ•°æ®å•å‘æµï¼Œæ˜¯ `onChange/setState` æ¨¡å¼ã€‚Vue æ˜¯åŒå‘ç»‘å®šã€‚



## 3. HoC å’Œ mixins

Vue é€šè¿‡ mixins æ–¹å¼åŒ…è£…å‡½æ•°ã€‚React ç”¨é«˜é˜¶ç»„ä»¶ã€‚



## 4. ç»„ä»¶é€šä¿¡åŒºåˆ«

![](https://img-blog.csdnimg.cn/20190626150244778.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTkwMTc3,size_16,color_FFFFFF,t_70) 

## 5. æ¡†æ¶æœ¬è´¨ä¸åŒ

- Vue æœ¬è´¨æ˜¯ MVVM æ¡†æ¶ï¼Œç”± MVC å‘å±•è€Œæ¥ã€‚
- React æ˜¯å‰ç«¯ç»„ä»¶åŒ–æ¡†æ¶ï¼Œç”±åç«¯ç»„ä»¶åŒ–å‘å±•è€Œæ¥ã€‚



# 12. BFC

è§¦å‘ BFC æ¡ä»¶ï¼š

- body æ ¹å…ƒç´ 
- æµ®åŠ¨å…ƒç´ ï¼šfloat é™¤ none ä»¥å¤–çš„å€¼
- ç»å¯¹å®šä½å…ƒç´ ï¼šposition (absoluteã€fixed)
- display ä¸º inline-blockã€table-cellsã€flex
- overflow é™¤äº† visible ä»¥å¤–çš„å€¼ (hiddenã€autoã€scroll)



# 13. æ•°æ®çš„å¤§å°ç«¯å­˜å‚¨

**å¤§ç«¯æ¨¡å¼**ï¼šæ•°æ®çš„é«˜å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ä¸­ï¼Œè€Œæ•°æ®çš„ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„é«˜åœ°å€ä¸­ã€‚

**å°ç«¯æ¨¡å¼**ï¼šæ•°æ®çš„é«˜å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„é«˜åœ°å€ä¸­ï¼Œè€Œæ•°æ®çš„ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ä¸­ã€‚

è®¡ç®—æœºä¸­ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œæ¯ä¸ªåœ°å€å•å…ƒå°±æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œä¸€å­—èŠ‚æ˜¯ 8 bitã€‚C è¯­è¨€ä¸­ï¼Œchar ç±»å‹æ˜¯ 8 bitï¼Œshort ç±»å‹æ˜¯ 16 bitï¼Œlong ç±»å‹æ˜¯ 32 bitã€‚

å¯¹äºä½æ•°å¤§äº 8 ä½çš„å¤„ç†å™¨ï¼Œ16 ä½æˆ– 32 ä½çš„å¤„ç†ï¼Œç”±äºå¯„å­˜å™¨å®½åº¦å¤§äºä¸€ä¸ªå­—èŠ‚ï¼Œå¿…ç„¶å­˜åœ¨ç€ä¸€ä¸ªå¦‚æœå°†å¤šä¸ªå­—èŠ‚å®‰æ’çš„é—®é¢˜ã€‚





# 14. corsè¯·æ±‚

## ç®€å•è¯·æ±‚

- GETã€POSTã€HEAD(å’Œ get æœ¬è´¨ä¸€æ ·ï¼Œä¸å«æ•°æ®åªæœ‰å¤´éƒ¨)ã€‚
- å¤´éƒ¨ä¿¡æ¯ä¸è¶…è¿‡ä¸‹é¢å†…å®¹ï¼š
  - æ— è‡ªå®šä¹‰å¤´éƒ¨ã€‚
  - Acceptï½œAccept-Languageï½œContent-Languag
  - Last-Event-ID
  - Content-Type åªèƒ½æ˜¯ï¼š`text/plain` ï½œ`multipart/form-data` ï½œ`application/x-www-form-urlencoded`

## éç®€å•è¯·æ±‚

- PUTï½œPATCHï½œDELETE
- è‡ªå®šä¹‰å¤´éƒ¨å­—æ®µ
- ==å‘é€ json æ•°æ®==

==æ­£å¼é€šä¿¡å‰ï¼Œæµè§ˆå™¨å…ˆå‘é€ OPTIONS è¯·æ±‚ï¼Œè¿›è¡Œé¢„æ£€è¯·æ±‚ã€‚æœåŠ¡å™¨æˆåŠŸå“åº”é¢„æ£€è¯·æ±‚åï¼Œæ‰ä¼šå‘é€çœŸæ­£è¯·æ±‚ï¼Œå¸¦ç€çœŸæ­£æ•°æ®ã€‚==

```js
$.ajax({
  url: 'http://...',
  type: put,
  success: data => console.log(data);
})
```

![æˆªå±2021-02-25 ä¸‹åˆ10.04.29](images/%E6%88%AA%E5%B1%8F2021-02-25%20%E4%B8%8B%E5%8D%8810.04.29.png)

æµè§ˆå™¨è‡ªå·±å…ˆå‘é€ä¸€ä¸ª OPTIONSã€‚



## æœåŠ¡ç«¯è®¾ç½®

```js
res.header("Access-Control-Allow-Origin", "*");
res.header("Access-Control-Allow-Methods", "PUT,POST,...")
res.header("Access-Control-Allow-Headers", "X-Request-With")
```



## å‚è€ƒ

1. jianshu.com/p/ebd498cc3c52



# 15. SSEå’ŒwebSocket

## SSE(Server-Sent Events) ï¼š

- HTTPåè®®ä¸¥æ ¼è¯´==æ— æ³•åšåˆ°æœåŠ¡å™¨ä¸»åŠ¨æ¨é€æ¶ˆæ¯==ã€‚
- å˜é€šæ–¹æ³•ï¼šå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œæ¥ä¸‹æ¥å‘é€çš„æµä¿¡æ¯ã€‚SSE å°±æ˜¯é€šè¿‡æµä¿¡æ¯çš„æ–¹å¼æ¨é€çš„ã€‚
- IE/Edgeï¼šä¸æ”¯æŒã€‚
- WebSocket æ˜¯å…¨åŒå·¥ï¼Œå¯ä»¥åŒå‘é€šä¿¡ã€‚SSE æ˜¯å•å‘é€šä¿¡ï¼šæœåŠ¡å™¨ => æµè§ˆå™¨ã€‚
- æµä¿¡æ¯çš„æ–¹å¼ï¼Œå®Œæˆä¸€æ¬¡ç”¨æ—¶å¾ˆé•¿çš„ä¸‹è½½ã€‚

### ä¼˜ç‚¹

- ä½¿ç”¨ HTTP åè®®ã€‚è€Œ WebSocket æ˜¯å¦ä¸€ä¸ªç‹¬ç«‹çš„åè®®ã€‚
- SSE æ˜¯è½»é‡çº§ã€‚WebSocket åè®®ç›¸å¯¹å¤æ‚ã€‚
- SSE é»˜è®¤æ”¯æŒæ–­çº¿é‡è¿ï¼ŒWebSocket éœ€è¦è‡ªå·±å®ç°ã€‚
- SSE ä¸€èˆ¬ç”¨æ¥ä¼ é€æ–‡æœ¬ï¼ŒäºŒè¿›åˆ¶éœ€è¦è‡ªå·±ç¼–ç åå‘é€ã€‚WebSocket é»˜è®¤äºŒè¿›åˆ¶ã€‚
- SSE æ”¯æŒè‡ªå®šä¹‰å‘é€æ¶ˆæ¯ç±»å‹ã€‚



## WebSocketä¼˜ç¼ºç‚¹

==ç¼ºç‚¹==

- æ˜¯é•¿è¿æ¥ï¼Œæ‰€ä»¥å—ç½‘ç»œé™åˆ¶å¤§ï¼Œè¦å¤„ç†å¥½æ–­ç½‘é‡è¿çš„åœºæ™¯ã€‚
- webSocket æ˜¯ push ä¸€ä¸ªæ¶ˆæ¯ï¼Œhttp è½®è¯¢æ˜¯ pull ä¸€ä¸ªæ¶ˆæ¯ã€‚æ‰€ä»¥ webSocket è¦æ³¨æ„æ¯ä¸ªæ¶ˆæ¯åªæ¨é€ä¸€æ¬¡ï¼Œå¤„ç†å¥½è¿æ¥ã€‚



==ä¼˜ç‚¹==

- æ”¯æŒé•¿è¿æ¥ï¼Œhttp ä¸èƒ½æŒä¹…è¿æ¥ã€‚

- æ¡æ‰‹å°±æ˜¯åŸºäº HTTP åè®®çš„ã€‚å¤šäº†çš„å­—æ®µï¼š

  ```js
  Sec-WebSocket-Key: xxxxxxxxx // æµè§ˆå™¨éšæœºç”Ÿæˆçš„Base64 encodeå€¼
  Sec-WebSocket-Protocol: chat, superchat // è®°å½•æ‰€ä½¿ç”¨çš„åè®®
  Upgrade: websocket
  Connection: Upgrades
  
  // å®¢æˆ·ç«¯
  Sec-WebSocket-Accept: xxxxxx // æ˜¯ä¸Šé¢çš„keyåŠ å¯†åçš„å­—æ®µ
  ```





## é•¿è½®è¯¢å’Œ ajax è½®å¾ªåŒºåˆ«

ajax ä¼šä¸€ç›´é—®é—®é—®ï¼šæœ‰æ¶ˆæ¯æ²¡ï½œæ²¡ã€‚ã€‚ï½œæœ‰æ¶ˆæ¯æ²¡ï½œæ²¡ã€‚ã€‚ã€‚

long pollï¼šå®ƒé‡‡ç”¨çš„æ˜¯ï¼šå®¢æˆ·ç«¯å‘èµ·è¿æ¥ï¼Œå¦‚æœæ²¡æ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯å°±ä¸€ç›´ä¸è¿”å› response ç»™å®¢æˆ·ç«¯ã€‚ç›´åˆ°æœ‰æ¶ˆæ¯ä¹‹åæ‰è¿”å›ï¼Œè¿”å›å®Œä¹‹åï¼Œå®¢æˆ·ç«¯å†æ¬¡å»ºç«‹è¿æ¥ã€‚





### ä½¿ç”¨

```js
// 1.æ£€æµ‹æ˜¯å¦æœ‰EventSourceå¯¹è±¡
if(window.EventSource){}

var source = new EventSource(url, {withCredentials: true});
source.readyState=>{
  0: EventSource.CONNECTING
  1: EventSource.OPEN å¯ä»¥æ¥å—æ•°æ®
  2: EventSource.CLOSED æ–­å¼€ä¸”ä¸ä¼šé‡è¿ã€‚
}

// onerror|source.close()å…³é—­
source.onmessage = function(e){
  var data = e.data;
  // handle message
}
```

==æœåŠ¡ç«¯å®ç°==

```js
// 1.HTTPå¤´éƒ¨ï¼š
Content-Type: text/event-stream
Cache-Control: no-cache
Connection: keep=alive
```







# ğŸŒŸ16. æ‰‹å†™å¹¶å‘æ§åˆ¶

```js
å®ç°ä¸€ä¸ªæ‰¹é‡è¯·æ±‚å‡½æ•° multiRequest(urls, maxNum)ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š
â€¢ è¦æ±‚æœ€å¤§å¹¶å‘æ•° maxNum
â€¢ æ¯å½“æœ‰ä¸€ä¸ªè¯·æ±‚è¿”å›ï¼Œå°±ç•™ä¸‹ä¸€ä¸ªç©ºä½ï¼Œå¯ä»¥å¢åŠ æ–°çš„è¯·æ±‚
â€¢ æ‰€æœ‰è¯·æ±‚å®Œæˆåï¼Œç»“æœæŒ‰ç…§ urls é‡Œé¢çš„é¡ºåºä¾æ¬¡æ‰“å‡º
```

ç”¨åˆ° `Promise.all` ï¼Œè¯¥æ–¹æ³•ä¿è¯æ‰€æœ‰çš„è¯·æ±‚éƒ½è¾¾åˆ° `resovle` æ‰æ‰§è¡Œ `then` å›è°ƒã€‚

å¹¶å‘é™åˆ¶æ˜¯æŒ‡ï¼š

- HTTP è¯·æ±‚æ—¶ï¼Œå¦‚æœæœ‰å¥½å¤šå¥½å¤šä¸ªåŒæ—¶ä¸€èµ·ï¼Œå°±ä¼šå †ç§¯æ— æ•°è°ƒç”¨æ ˆå¯¼è‡´å†…å­˜æº¢å‡ºã€‚
- æ‰€ä»¥æˆ‘ä»¬ç”¨ `Promise.all` è®©æ¯ä¸€æ—¶åˆ»çš„å¹¶å‘æ‰§è¡Œçš„ `promise` æ•°é‡æ˜¯å›ºå®šçš„ã€‚



==æ€è·¯==

```js
function PromiseLimit(fnArr, limit=5) {
  let i = 0;
  const res = []; //ä¿å­˜æ¯ä¸ªpromiseçš„æ‰§è¡Œç»“æœ
  const executing = []; //ä¿å­˜æ­£åœ¨æ‰§è¡Œçš„promiseå¯¹è±¡
  return queue().then(() => Promise.all(res));
  
  const queue = () => {
    if(i === fnArr.length) return Promise.all(executing);
    const p = fnArr[i++]();
    res.push(p);
    const e = p.then(() => executing.splice(executing.indexOf(e), 1));
    executing.push(e);
    if(executing.length >= limit){
			return Promise.race(executing).then(() => queue(), err => reject(err));
    }
    return Promise.resolve().then(() => queue());
  }
}
```



==æµ‹è¯•æ¡ˆä¾‹ï¼š==è®¾ç½®ä¸€ä¸ªéšæœºç”ŸæˆæˆåŠŸå’Œå¤±è´¥çš„å»¶æ—¶å¯åŠ¨å™¨

```js
const res = [];
for(let i=0;i<10;i++){
  res.push(function(){
    return new Promise(resolve, reject){
      console.log('å¼€å§‹'+i, new Date().toLocaleString());
      setTimeout(() => {
        if(Math.random() > 0.3) resolve(i);
        else reject(i+"  error!!!!");
      }, parseInt(Math.random()*10000));
    }
  })
}

PromiseLimit(res).then(data => console.log(data), err => console.log(err));
```



## å‚è€ƒ

1. https://blog.csdn.net/qq_20282263/article/details/103686738







# ğŸŒŸ17. å®ç°å¸¦å¹¶å‘é™åˆ¶çš„å¼‚æ­¥è°ƒåº¦å™¨

```js
class Scheduler {
  add(promiseCreator) {  }
  // ...}const timeout = (time) => new Promise(resolve => {
  setTimeout(resolve, time);
}
const scheduler = new Scheduler()
const addTask = (time, order) => {
  scheduler.add(() => timeout(time))
    .then(() => console.log(order))
}

addTask(1000, '1')
addTask(500, '2')
addTask(300, '3')
addTask(400, '4') // output: 2 3 1 4
// ä¸€å¼€å§‹ï¼Œ1ã€2ä¸¤ä¸ªä»»åŠ¡è¿›å…¥é˜Ÿåˆ—
// 500msæ—¶ï¼Œ2å®Œæˆï¼Œè¾“å‡º2ï¼Œä»»åŠ¡3è¿›é˜Ÿ
// 800msæ—¶ï¼Œ3å®Œæˆï¼Œè¾“å‡º3ï¼Œä»»åŠ¡4è¿›é˜Ÿ
// 1000msæ—¶ï¼Œ1å®Œæˆï¼Œè¾“å‡º1// 1200msæ—¶ï¼Œ4å®Œæˆï¼Œè¾“å‡º4
```



==å®ç°==

```js
class Scheduler {
  constructor (limit) {
    this.limit = limit;
    this.queue = [];
  }
  add = (promiseCreator) => {
    return new Promise((resolve, reject) => {
      if(this.limit > 0) {
        resolve(promiseCreator());
        this.limit--;
      } else this.queue.push([resolve, promiseCreator]);
    }).then(() => {
      if(this.queue.length) {
        let task = this.queue.shift();
        task[0](task[1]());
      }else this.limit++;
     	return Promise.resolve();
    });
    
  }
}

// æµ‹è¯•ä»£ç 
const scheduler = new Scheduler(2);
const addTask = (time, order) => {
  scheduler.add(function(){
    return new Promise((resolve) => setTimeout(resolve, time))
    	.then(() => console.log('time', time, 'order', order))
  })
}
```



# 18. æ— åºæ•°ç»„æ„å»ºäºŒå‰æœç´¢æ ‘

```js
è¦æ±‚ï¼šè¾“å…¥ä¸€ä¸ªæ— åºæ•°ç»„ï¼Œæ„å»ºä¸€ä¸ªäºŒå‰æœç´¢æ ‘ï¼Œç„¶ååœ¨éå†äºŒå‰æœç´¢æ ‘è·å¾—é€’å¢åºåˆ—ã€‚
```

å®ç°ï¼š

```js
function TreeNode(val) {
  this.val = val;
  this.left = null;
  this.right = null;
}

function constructTree(arr){
  const root = new TreeNode(arr[0]);
  // æŠŠæ‰€æœ‰çš„æ•°å­—æ’å…¥rootä¸­å˜æˆäºŒå‰æœç´¢æ ‘
  for(let i=1;i<arr.length;i++){
    insert(arr[i]);
  }
  const res = [];
  traverse(root); //ä¸­åºéå†äºŒå‰æœç´¢æ ‘æŠŠvalæŒ‰åºæ”¾å…¥res
  return res;
  
  function insert(val){
    const newNode = new TreeNode(val);
    insertNode(root, newNode);
  }
  function insertNode(node, newNode){
		if(node.val > newNode.val) {
      if(!node.left) node.left = newNode;
      else insertNode(node.left, newNode);
    }else{
      if(!node.right) node.right = newNode;
      else insertNode(node.right, newNode);
    }
  }
  
  function traverse(node){
		if(node.left) traverse(node.left);
    if(!node) return null;
    res.push(node.val);
    if(node.right) traverse(node.right);
  }
}
```







# 19. å›¾ç‰‡æ‡’åŠ è½½

```js
var imgs = document.querySelectorAll('img');
// åˆ°æµè§ˆå™¨é¡¶éƒ¨çš„è·ç¦»
function getTop(e) {
  return e.offsetTop; //ç›®æ ‡è·ç¦»æµè§ˆå™¨é¡¶éƒ¨çš„è·ç¦»
}
function lazyLoad(imgs) {
  let h = document.body.clientHeight; // æµè§ˆå™¨çª—å£é«˜åº¦
  // æ»šåŠ¨è¿‡çš„å®½åº¦
  var s = document.documentElement.scrollTop || document.body.scrollTop;
  for (let i = 0; i < imgs.length; i++) {
    if (h + s > getTop(img[i])) {
      // æ¨¡æ‹Ÿè¯·æ±‚è¿‡ç¨‹ï¼Œæ‰€ä»¥åŠ äº†å®šæ—¶å™¨2s
      setTimeout(() => {
        const tmp = new Image();
        tmp.src = imgs[i].getAttribute('data-src');
        tmp.onload = function () {
          imgs[i].src = imgs[i].getAttribute('data-src');
        };
      }, 2000);
    }
  }
}
lazyLoad(imgs);
```







# 20.å®ç°vDomå¯¹è±¡æ¸²æŸ“é¡µé¢

```js
const vDom = {
  tag: 'ul',
  attrs: {
    id: 'list',
  },
  children: [
    {
      tag: 'li',
      attrs: { className: 'item' },
      content: 'Item1',
    },
    {
      tag: 'li',
      attrs: { className: 'item' },
      content: 'Item2',
    },
  ],
};
function render(vDom) {
  const { tag, attrs = {}, children = [], content = '' } = vDom;
  if (!tag) return null;
  let elem = document.createElement(tag);
  for (const key in attrs) {
    elem.setAttribute(key, attrs[key]);
  }
  elem.innerHTML = content;
  children.forEach(item => {
    elem.appendChild(render(item));
  });
  return elem;
}

console.log(render(vDom));
const div = document.querySelector('div');
div.appendChild(render(vDom));
```













